<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Q-isdef</title>
<link rel="stylesheet" href="faq.css">
</head>
<body>
<div class="breadcrumbs">
<a href="index.html">FAQ</a> &gt; <a href="index.html#Macroprogramming">Macro programming</a> &gt; <a href="index.html#ldquoGenericrdquomacrosandtechniques">&ldquo;Generic&rdquo; macros and techniques</a> &gt; <a href="index.html#Q-isdef">Is this command defined?</a><h1>Is this command defined?</h1>


<p>

<p>
Macro sets from the earliest days of TeX programming may be
observed to test whether commands exist by using
<blockquote>
<code>&#x5c;ifx</code> <code>&#x5c;</code><tt><em>command</em></tt> <code>&#x5c;undefined</code> &lsaquo;<i>stuff</i>&rsaquo; &hellip;
</blockquote>
(which of course actually tests that the command <em>doesn&rsquo;t</em>
exist).  LaTeX programmers can make use of the internal command
<blockquote>
  <code>&#x5c;@ifundefined</code><code>&#x7b;cmd name&#x7d;</code></code><code>&#x7b;action1&#x7d;</code>[[[LBRACE]]]action2[[[RBRACE]]]
</blockquote>
which executes <tt>action1</tt> if the command is undefined, and
<tt>action2</tt> if it is defined
(<em>cmd name</em> is the command name only, omitting the &lsquo;<code class="verb">\</code>&rsquo; character).

<p>
The <code>&#x5c;@ifundefined</code> command is based on the sequence
<blockquote>

<pre>
\expandafter
    \ifx\csname cmd name\endcsname\relax
</pre>


<pre>
\expandafter \ifx \csname cmd name\endcsname \relax
</pre>

</blockquote>
which relies on the way <code>&#x5c;csname</code> works: if the command doesn&rsquo;t
exist, it simply creates it as an alias for <code>&#x5c;relax</code>.

<p>
So: what is wrong with these techniques?

<p>
Using <code>&#x5c;undefined</code> blithely assumes that the command is indeed not
defined.  This isn&rsquo;t entirely safe; one could make the name more
improbable, but that may simply make it more difficult to spot a
problem when things go wrong.  LaTeX programmers who use the
technique will typically employ <code>&#x5c;@undefined</code>, adding a single
level of obscurity.

<p>
The <code>&#x5c;@ifundefined</code> mechanism has the unfortunate property of
polluting the name space: each test that turns out undefined adds a
name to the set TeX is holding, and often all those &ldquo;<code>&#x5c;relax</code>&rdquo;
names serve no purpose whatever.  Even so (sadly) there are places in
the code of LaTeX where the existence of the <code>&#x5c;relax</code> is relied
upon, after the test, so we can&rsquo;t get away from <code>&#x5c;@ifundefined</code>
altogether.

<p>
David Kastrup offers the (rather tricky)
<blockquote>

<pre>
{\expandafter}\expandafter\ifx \csname cmd name\endcsname\relax ...
</pre>


<pre>
{\expandafter}\expandafter
    \ifx \csname cmd name\endcsname \relax ...
</pre>

</blockquote>
which &ldquo;creates&rdquo; the <code>&#x5c;relax</code>-command inside the group of the first
<code>&#x5c;expandafter</code>, therefore forgets it again once the test is done.
The test is about as good as you can do with macros.

<p>
The <a href="FAQ-etex.html">e-TeX system</a> system comes to our help here: it
defines two new primitives:
<ul>
<li> <code>&#x5c;ifdefined</code>, which tests whether a thing is defined (the
  negative of comparing with <code>&#x5c;undefined</code>, as it were), and
<li> <code>&#x5c;ifcsname</code> <tt>cmd name</tt><code>&#x5c;endcsname</code>, which does the
  negative of <code>&#x5c;@ifundefined</code> without the <code>&#x5c;relax</code>-command
  side-effect.
</ul>
So, in an e-TeX-based system, the following two conditional clauses do
the same thing:
<blockquote>
<pre>
\ifdefined\foo
  \message{\string\foo\space is defined}%
\else
  \message{no command \string\foo}%
\fi
%
\ifcsname foo\endcsname
  \message{\string\foo\space is defined}%
\else
  \message{no command \string\foo}%
\fi
</pre>
</blockquote>
However, after using the LaTeX
<code>&#x5c;@ifundefined</code><code>&#x7b;foo&#x7d;</code>&hellip;, the conditionals will detect the
command as &ldquo;existing&rdquo; (since it has been <code>&#x5c;let</code> to <code>&#x5c;relax</code>);
so it is important not to mix mechanisms for detecting the state of a
command.

<p>
Since most distributions nowadays use e-TeX as their base executable
for most packages, these two primitives may be expected appear widely
in new macro packages.

<p>

<p>

<p>
